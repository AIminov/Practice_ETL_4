 –®–∞–≥ 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ø–∏–∏ –≤–∏—Ç—Ä–∏–Ω—ã
–§–∞–π–ª: 00_ddl/02_dm.dm_f101_round_f_v2.sql

–°–æ–¥–µ—Ä–∂–∏—Ç CREATE TABLE dm.dm_f101_round_f_v2 (...)

–ü–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ–ø–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Å–Ω–æ–≤–Ω–æ–π –≤–∏—Ç—Ä–∏–Ω—ã dm.dm_f101_round_f

üîπ –®–∞–≥ 2. –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
–§–∞–π–ª: 03_csv_export_import/01_export_f101_to_csv.py

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç dm.dm_f101_round_f.csv —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏

–õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ logs.etl_stdout_log

script_name = '01_export_f101_to_csv.py'

step = 'EXPORT'

üîπ –®–∞–≥ 3. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CSV
–í—Ä—É—á–Ω—É—é –∏–∑–º–µ–Ω–µ–Ω–æ 1‚Äì2 –∑–Ω–∞—á–µ–Ω–∏—è

CSV –æ—Å—Ç–∞—ë—Ç—Å—è –≤ 03_csv_export_import/dm_f101_round_f.csv

üîπ –®–∞–≥ 4. –ò–º–ø–æ—Ä—Ç –∏–∑ CSV
–§–∞–π–ª: 03_csv_export_import/02_import_f101_from_csv.py

–ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ dm.dm_f101_round_f_v2

–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ—á–∏—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É

–õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ logs.etl_stdout_log

script_name = '02_import_f101_from_csv.py'

step = 'IMPORT'

üîπ –®–∞–≥ 5. –¢–∞–±–ª–∏—Ü–∞ –ª–æ–≥–æ–≤
–¢–∞–±–ª–∏—Ü–∞: logs.etl_stdout_log

–°–æ–∑–¥–∞–Ω–∞ –≤ –∑–∞–¥–∞–Ω–∏–∏ 1.4 —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è Python-—Å–∫—Ä–∏–ø—Ç–æ–≤

–§–∞–π–ª: 00_ddl/01_logs.etl_stdout_log.sql

–ü–æ–ª—è: log_dt, script_name, step, message

üîπ –®–∞–≥ 6. –û–±—ä–µ–¥–∏–Ω—è—é—â–∏–π —Å–∫—Ä–∏–ø—Ç
–§–∞–π–ª: etl_practice_4.sh

–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:

—Å–æ–∑–¥–∞—ë—Ç –∫–æ–ø–∏—é –≤–∏—Ç—Ä–∏–Ω—ã,

–∑–∞–ø—É—Å–∫–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç,

–ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤—Ä—É—á–Ω—É—é –∏–∑–º–µ–Ω–∏—Ç—å CSV,

–≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–º–ø–æ—Ä—Ç

üîπ –®–∞–≥ 7. –ü—Ä–æ–≤–µ—Ä–∫–∏
sql
Copy
Edit
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–º–ø–æ—Ä—Ç–∞
SELECT * FROM dm.dm_f101_round_f_v2 ORDER BY from_date, ledger_account LIMIT 20;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
SELECT * FROM logs.etl_stdout_log ORDER BY log_dt DESC;
