В этом задании реализован экспорт данных из витрины dm.dm\_f101\_round\_f в CSV-файл, последующее редактирование файла и импорт изменённых данных обратно в базу данных в таблицу dm.dm\_f101\_round\_f\_v2. Все действия сопровождаются логированием в таблицу logs.etl\_stdout\_log.



Файлы:



00\_ddl/01\_logs.etl\_stdout\_log.sql

Создаёт таблицу для логирования выполнения python-скриптов



00\_ddl/02\_dm.dm\_f101\_round\_f\_v2.sql

Создаёт копию витрины dm.dm\_f101\_round\_f с именем dm.dm\_f101\_round\_f\_v2



01\_csv\_export\_import/01\_export\_f101\_to\_csv.py

Экспортирует данные из таблицы dm.dm\_f101\_round\_f в файл dm\_f101\_round\_f.csv

Файл сохраняется с заголовками колонок

Результат логируется в logs.etl\_stdout\_log



01\_csv\_export\_import/02\_import\_f101\_from\_csv.py

Импортирует данные из файла dm\_f101\_round\_f.csv в таблицу dm.dm\_f101\_round\_f\_v2

Предварительно очищает таблицу

Результат логируется в logs.etl\_stdout\_log



Не забудьте внести свои данные в CONFIG.YAML! :)



etl\_practice\_4.sh

Общий bash-скрипт, который выполняет создание копии витрины, экспорт в CSV, ожидает редактирование файла и выполняет импорт



Формат логов:

logs.etl\_stdout\_log содержит поля log\_dt, script\_name, step, message



Проверка:

SELECT \* FROM dm.dm\_f101\_round\_f\_v2 LIMIT 10;

SELECT \* FROM logs.etl\_stdout\_log ORDER BY log\_dt DESC;



Данные были успешно экспортированы, отредактированы вручную и загружены обратно в отдельную таблицу. Логи выполнения отображаются в таблице logs.etl\_stdout\_log.

